---
title: "ABC078 D - ABS (500点)"
description:
tags:
  - 競技プログラミング
  - AtCoder
  - ABC
  - ゲーム
  - DP
  - 選べる手が決まっている
created_at: 2019-11-26
updated_at: 
draft: false
---

# 問題
[D - ABS](https://atcoder.jp/contests/abc078/tasks/arc085_b)

# 考察
けんちょんさんの解説にあるDPで解いてみます（[参考](http://drken1215.hatenablog.com/entry/2019/05/11/133400)）。この記事はけんちょんさんの解説の状態遷移図を書いただけのものなので、そんなに価値のあるものではありません。けんちょんさんの記事の方をなるべく見ましょう。

dpの状態は

> dp[ 山札からとった枚数 ][ 後手かどうか ] := その状態からスタートしたときの、最終的なカードの数値の差の最適値 (先手なら最大値、後手なら最小値) （[引用元](http://drken1215.hatenablog.com/entry/2019/05/11/133400)）

です。

dpの遷移は、

`dp[i][*]`が**i枚のカードがとられた状態からのスタート**であることに留意して、

- **先手**
  - 残りすべてのカードをとる場合
    - 後手が持っているカード `y = (i == 0 ? W : a[i-1])`
    - `dp[i][0] = max(dp[i][0], abs(y - a[N-1]))`
  - `i < j`となるj番目のカードをとる場合
    - `dp[i][0] = max(dp[i][0], dp[j][1])`
- **後手**
  - 残りすべてのカードをとる場合
    - 後手が持っているカード `x = (i == 0 ? Z : a[i-1])`
    - `dp[i][1] = max(dp[i][1], abs(x - a[N-1]))`
  - `i < j`となるj番目のカードをとる場合
    - `dp[i][1] = max(dp[i][1], dp[j][0])`

です。


問題の入力例1を例に、以下のDPテーブルを埋めていきます。`dp[i][0]`が先手、`dp[i][1]`が後手とします。図中の\\(a\\)の添字は0-indexedとします。

> 入力例1:  
3 100 100   
10 1000 100

![状態遷移図](/posts_images/2019-11-26-abc078_d/01.png)

`dp[2][0]`を埋めます。これは、**残りすべてのカードをとる場合**（2枚目(\\(a_1\\))まで取られた状態で先手が3枚目(\\(a_2\\))をとる場合）です。後手は\\(a_1\\)を持っているので、スコアは\\(|a_1 - a_2|\\)です。



![状態遷移図](/posts_images/2019-11-26-abc078_d/02.png)

同様に後手の**残りすべてのカードをとる場合**の遷移で`dp[2][1]`を埋めます。

![状態遷移図](/posts_images/2019-11-26-abc078_d/03.png)

次に、後手の**残りすべてのカードをとる場合**の遷移で`dp[1][0]`を埋めます。

![状態遷移図](/posts_images/2019-11-26-abc078_d/04.png)

この`i = 1`の場合においては、まだ1枚のカードしかとられていません。つまり、残り全てのカードをとる以外にも選択肢があります。2枚目のカードだけをとるという選択です。

この選択をした場合のスコアはいくつでしょうか。
これは、「2枚のカードがとられた状態から後手でスタートしたときの最適値」に等しいです。これはすでに計算済みの`dp[2][1]`です。今回は`dp[2][1]`の方が大きいのでスコアを書き換えます。


![状態遷移図](/posts_images/2019-11-26-abc078_d/05.png)

以下、同様にテーブルを埋めます。

![状態遷移図](/posts_images/2019-11-26-abc078_d/06.png)
![状態遷移図](/posts_images/2019-11-26-abc078_d/07.png)
![状態遷移図](/posts_images/2019-11-26-abc078_d/08.png)
![状態遷移図](/posts_images/2019-11-26-abc078_d/09.png)
![状態遷移図](/posts_images/2019-11-26-abc078_d/10.png)

`dp[0][0]`が求める答えとなります。

![状態遷移図](/posts_images/2019-11-26-abc078_d/11.png)


[submission(Ruby)](https://atcoder.jp/contests/abc078/submissions/8658278)

# 参考
1. [AtCoder ARC 085 D - ABS (500 点) - けんちょんの競プロ精進記録](http://drken1215.hatenablog.com/entry/2019/05/11/133400)